# Copyright Â© 2022-2024, SAS Institute Inc., Cary, NC, USA. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0

---
## NFS CSI Driver
CSI_DRIVER_NFS_NAME: csi-driver-nfs-sas
CSI_DRIVER_NFS_NAMESPACE: kube-system
CSI_DRIVER_NFS_CHART_NAME: csi-driver-nfs
CSI_DRIVER_NFS_CHART_URL: https://raw.githubusercontent.com/kubernetes-csi/csi-driver-nfs/master/charts
CSI_DRIVER_NFS_CHART_VERSION: 4.11.0
CSI_DRIVER_NFS_CONFIG:
  driver:
    mountPermissions: "0777"
  storageClass:
    create: true
    name: sas
    annotations: {}
    reclaimPolicy: Delete
    volumeBindingMode: Immediate
    parameters:
      server: "{{ nfs_ip }}"
      share: /srv/nfs/kubernetes/sc/default
      subdir: ${pvc.metadata.namespace}-${pvc.metadata.name}-${pv.metadata.name}
      mountPermissions: "0777"
    mountOptions:
      - vers=4.1
      - nolock
      - noatime
      - nodiratime
      - rsize=262144
      - wsize=262144

## PostgreSQL Storage Class definition (created separately via k8s resource)
PG_STORAGE_CLASS_DEFINITION:
  apiVersion: storage.k8s.io/v1
  kind: StorageClass
  metadata:
    name: pg-storage
  provisioner: nfs.csi.k8s.io
  reclaimPolicy: Retain
  volumeBindingMode: Immediate
  allowVolumeExpansion: true
  parameters:
    server: "{{ nfs_ip }}"
    share: /srv/nfs/kubernetes/sc/default
    subdir: ${pvc.metadata.namespace}-${pvc.metadata.name}-${pv.metadata.name}
    mountPermissions: "0777"
  mountOptions:
    - vers=4.1
    - noatime
    - nodiratime
    - rsize=262144
    - wsize=262144